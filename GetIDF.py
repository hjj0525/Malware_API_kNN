import os
import numpy as np

def makeNgram(n, lines):
    dic ={}

    for i in range(len(lines)-n+1):
        ngram = ''
        for j in range(n):
            ngram += lines[i+j][:-1] 
        dic[ngram] = 1
            
    return dic


def main():
    dicIDF = {}
    paths = ['C:/Users/hwang/OneDrive/바탕 화면/학업/3-2/컴퓨터보안/Assignment#2/program/API/0_pre/',
            'C:/Users/hwang/OneDrive/바탕 화면/학업/3-2/컴퓨터보안/Assignment#2/program/API/1_pre/',
            'C:/Users/hwang/OneDrive/바탕 화면/학업/3-2/컴퓨터보안/Assignment#2/program/API/0_test/',
            'C:/Users/hwang/OneDrive/바탕 화면/학업/3-2/컴퓨터보안/Assignment#2/program/API/1_test/']
    
    fileList = []
    
    cnt = 0
    
    for path in paths:
        fileList = os.listdir(path)
        
        for file in fileList:    
            f = open(path + file,'r')
            lines = f.readlines()
            
            dicTmp = makeNgram(4, lines)
            cnt += 1
            print(cnt)
            
            for key in dicTmp.keys():
                if key in dicIDF:
                    dicIDF[key] += 1
                else:
                    dicIDF[key] = 1
            
            f.close()
            
        
    for key in dicIDF.keys():
        dicIDF[key] = np.log10(2100.0 / (1+dicIDF[key]))
    
    f = open('IDFLIST.txt', 'w')
    for key in dicIDF.keys():
        string = str(key) + ' ' + str(dicIDF[key]) + '\n'
        f.write(string)
        
    
if __name__ == "__main__":
    main()